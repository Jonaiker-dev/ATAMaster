<app-navbar></app-navbar>

<div class="container py-5">
    <!-- Título -->
    <h5 class="fw-bold">Partidas Agregadas</h5>
    <p class="text-muted"><span class="fw-bolder">{{ps.Partidas().length}}</span> partidas en total</p>

    <!-- Botón -->
    <div class="mb-4 d-flex flex-lg-row flex-column gap-2 ">
      <div>
        <button class="btn btn-primary  align-items-center fw-semibold" data-bs-toggle="modal" data-bs-target="#inventoryModal">
          <i class="bi bi-plus-lg me-2 "></i> Agregar Partida
        </button>
        <app-formulario-ubicacion></app-formulario-ubicacion>
      </div>
      <div>
        <button type="button" class="btn btn-warning  fw-semibold" data-bs-toggle="modal" data-bs-target="#dataManagementModal">
          <i class="bi bi-folder-fill me-2"></i>  Archivos Guardados
        </button>
        <app-modal-storage> </app-modal-storage>
      </div>

    </div>

    
    
    
    <!-- Card vacía -->
    <div class="card p-4 text-center" *ngIf="!ps.Partidas().length">
      <div class="icon-box mb-3">
        <i class="bi bi-box"></i>
      </div>
      <h6 class="fw-bold">Sin partidas agregadas</h6>
      <p class="text-muted mb-0">Aqui se mostraran todas las partidas agregadas</p>
    </div>

    
    <!-- Tabla de Partidas -->
    <div class="card p-3" *ngIf="ps.Partidas().length">
  

    <!-- Botones -->
    <div class="d-flex gap-2 mb-3">
      <button class="btn btn-success" data-bs-toggle="modal" data-bs-target="#exportModal" >
        <i class="bi bi-file-earmark-excel me-1"></i> Exportar Excel
      </button>
      <button class="btn btn-danger" *ngIf="false">
        <i class="bi bi-file-earmark-pdf me-1"></i> Export PDF
      </button>
     
    </div>

   <div class="modal fade" id="exportModal" tabindex="-1" aria-labelledby="exportModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header border-0 pb-0">
        <h5 class="modal-title d-flex align-items-center" id="exportModalLabel">
          <i class="bi bi-file-earmark-excel-fill text-success me-2 fs-4"></i> Exportar a Excel
        </h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body pt-0">
       
          <div class="mt-3">
            <label for="fileName" class="form-label text-muted">Archivo</label>
            <input type="text" class="form-control" placeholder="Nombre del archivo" id="filename" #nombre>
            <small class="form-text text-muted mt-2">Con este nombre se guardara tu archivo</small>
          </div>
        
      </div>
      <div class="modal-footer border-0 d-flex flex-column"> <button type="button" class="btn btn-outline-secondary w-100 mb-2" data-bs-dismiss="modal"> <i class="bi bi-x-lg me-1"></i> Cancelar
        </button>
        <button type="button" class="btn btn-success w-100" (click)="ExportarExcel(nombre.value)" data-bs-dismiss="modal"> <i class="bi bi-floppy2-fill me-1" ></i> Guardar
        </button>
      </div>
    </div>
  </div>
</div>


    <!-- Tabla con scroll -->
    <div class="table-responsive" >
      <table class="table table-hover align-middle">
        <thead class="table-light">
          <tr>
            <th>Id</th>
            <th>Partida</th>
            <th>Peso</th>
            <th>Ubicacion</th>
            <th>Tipo de Tela</th>
            <th>Rollos</th>
            <th>Observacion</th>
            <th>Acciones</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let p of ps.Partidas(), let i=index" >
              <td class="fw-bold" #tr>{{i+1}}</td>
              <td>{{p.partidas}}</td>
              <td>{{p.peso}}</td>
              <td>{{p.ubicacion}}</td>
              <td>{{p.tipo_tela}}</td>
              <td>{{p.rollos}}</td>
              <td>{{p.observacion}}</td>
              <td><button class="border-0" style="background-color: inherit;"><i class="bi bi-trash text-danger" (click)="EliminarRegistro(tr.textContent!)"></i></button></td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  </div>